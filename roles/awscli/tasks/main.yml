---


- name: install awscli
  pip:
    name: awscli
    extra_args: --user

- name: setup environment variable for pip local bin
  lineinfile:
    dest: "{{ ansible_user_dir }}/.profile"
    regexp: '^export PATH=~/.local/bin:\$PATH'
    line: "export PATH=~/.local/bin:$PATH"
    insertafter: "EOF"

- name: awscli | install aws EB CLI
  pip:
    name: awsebcli
    extra_args: --upgrade --user
  when: AWSCLI_OPTION_AWSEBCLI == 'yes'

- include_tasks: install_aws_ecs_cli.yml

- name: awscli | check if git-secrets directory exist
  stat:
    path: "{{ ansible_user_dir }}/.git-templates/git-secrets"
  register: result

- include_tasks: install_git_secrets.yml
  when: not result.stat.exists
